# K마트 영수증 스캐너 — 레이아웃 정리

현재 프로젝트 구조와 화면 레이아웃을 정리한 문서입니다.  
(기준: `frontend/src/App.jsx`, `App.css`, 각 페이지·컴포넌트)

---

## 1. 프로젝트 구조

```
my-kmart/
├── backend/                    # FastAPI 백엔드
│   ├── app/
│   │   ├── main.py             # API 진입점
│   │   └── services/
│   │       ├── db_service.py   # Supabase 연동
│   │       ├── ocr_service.py  # Gemini OCR
│   │       └── stats_service.py # 대시보드 통계
│   └── requirements.txt
├── frontend/
│   ├── src/
│   │   ├── App.jsx             # 라우터, 헤더/메인/네비 구조
│   │   ├── App.css             # 전역 변수, 공통·스캔·결과 테이블 스타일
│   │   ├── main.jsx
│   │   ├── components/
│   │   │   ├── Camera.jsx       # 카메라 촬영
│   │   │   ├── ImagePreview.jsx
│   │   │   ├── ResultTable.jsx # 인식 결과·저장
│   │   │   └── common/
│   │   │       ├── Navigation.jsx  # 하단 탭 (스캔/대시보드/영수증)
│   │   │       └── Navigation.css
│   │   ├── pages/
│   │   │   ├── ScanPage.jsx    # /  — 카메라 → 미리보기 → 결과
│   │   │   ├── Dashboard.jsx   # /dashboard
│   │   │   ├── Dashboard.css
│   │   │   ├── ReceiptList.jsx # /receipts
│   │   │   └── ReceiptList.css
│   │   └── services/
│   │       └── api.js          # 백엔드 API 호출
│   ├── index.html
│   └── vite.config.js
└── docs/
```

---

## 2. 앱 공통 레이아웃 (모든 화면)

```
┌─────────────────────────────────────────┐
│  .app-header (sticky, 60px)             │  ← 전체화면 버튼(조건부) + 페이지별 제목
├─────────────────────────────────────────┤
│                                         │
│  .app-main (flex: 1, 세로 스크롤)        │  ← 라우트별 콘텐츠 (스캔 / 대시보드 / 영수증)
│  padding + padding-bottom(네비 높이)     │
│                                         │
├─────────────────────────────────────────┤
│  .bottom-nav (fixed bottom, 64px)       │  ← 스캔 | 대시보드 | 영수증 (3탭)
└─────────────────────────────────────────┘
```

- **헤더**  
  - 높이: `--header-height` (60px).  
  - 제목: 경로에 따라 "K마트 영수증 스캐너" / "대시보드" / "영수증 목록".  
  - 전체화면 버튼: iOS·비보안 등 조건에서만 표시, 왼쪽 절대 위치.
- **메인**  
  - `flex: 1`, `overflow-y: auto`, `min-height: 0`, `max-height: var(--available-height)`.  
  - 하단 네비 높이만큼 `padding-bottom`으로 가려지지 않게 함.
- **푸터**  
  - `.app-footer`는 `display: none` (하단 네비로 대체).
- **하단 네비**  
  - `position: fixed; bottom: 0`, `--nav-height: 64px`, `z-index: 1000`.  
  - 768px 이상에서는 상단으로 이동(`top: 0`, `bottom: auto`).

---

## 3. 라우팅·페이지 구성

| 경로 | 컴포넌트 | 설명 |
|------|-----------|------|
| `/` | `ScanPage` | 스캔 플로우: 카메라 → 미리보기 → 인식 결과(ResultTable) |
| `/dashboard` | `Dashboard` | 기간별 요약 카드, 월별 차트, 상점별 지출, 자주 구매 상품 |
| `/receipts` | `ReceiptList` | 기간·검색·필터, 영수증 카드 목록, 클릭 시 상세 모달 |

---

## 4. 페이지별 레이아웃

### 4.1 스캔 페이지 (`/` — ScanPage)

- **구성**  
  - 처리 중: `processing-overlay` (스피너 + 문구).  
  - 에러: `error-message` + 닫기.  
  - 상태에 따라 아래 중 하나만 표시:
    - **결과 있음** → `ResultTable` (테이블 + 영수증 정보 + 저장/새 스캔).
    - **캡처 없음** → `Camera` (비디오 + 가이드 오버레이 + 컨트롤).
    - **캡처 있음** → `ImagePreview` (이미지 + 다시 촬영 / 이미지 분석).

- **Camera**  
  - `.camera-container`: 세로 flex, `gap`, `flex: 1`.  
  - `.video-wrapper`: `max-height: var(--camera-height)`, 비디오 + `.receipt-guide`(가이드).  
  - `.camera-controls`: 시작·후면/전면·촬영·종료 버튼, `min-height: var(--controls-height)`.

- **ImagePreview**  
  - `.preview-container`: 이미지 + "다시 촬영" / "이미지 분석" 버튼.

- **ResultTable**  
  - `.result-container`: 제목 → (편집 안내) → 테이블 → `.receipt-info` → 원문 → 저장/새 스캔.

### 4.2 대시보드 (`/dashboard` — Dashboard)

- **최대 너비**  
  - `.dashboard` 내부는 `--page-max-width: 1200px`로 제한(대시보드·영수증 공통).

- **위에서부터 순서**
  1. **날짜 구간**  
     `.date-range-section` (App.css 공통): 시작일~종료일 DatePicker + "이번 달 / 지난 달 / 3개월 / 올해" 퀵 버튼.
  2. **요약 카드 3개**  
     `.summary-cards` → `.summary-card` × 3 (총 지출, 영수증 수, 평균 금액).
  3. **월별 지출 차트**  
     `.chart-section` → Recharts `BarChart` (월별 금액).
  4. **상점별 지출**  
     `.store-list` → `.store-item` (순위, 상점명, 방문 횟수, 금액·비율, 접기/펼치기 화살표).  
     클릭 시 `.store-card-detail` (카드별 지출 리스트) 펼침.
  5. **자주 구매하는 상품**  
     `.frequent-items` 테이블: 순위, 상품명, 구매 횟수, 총 금액, 평균 주기.

- **데이터 없음**  
  - `monthlyData`, `storeData` 모두 없으면 "선택한 기간에 데이터가 없습니다" 메시지.

### 4.3 영수증 목록 (`/receipts` — ReceiptList)

- **최대 너비**  
  - `--page-max-width` 적용(대시보드와 동일).

- **위에서부터 순서**
  1. **날짜 구간**  
     `.date-range-section` (대시보드와 동일 스타일).
  2. **상품명 검색**  
     `.receipt-search-section` — 텍스트 입력 한 줄.
  3. **필터 행**  
     `.receipt-filters-row`: "모든 상점" / "모든 카드" 셀렉트 + "초기화" 버튼(필터 있을 때만 활성).
  4. **영수증 목록**  
     `.receipts-section` → `.receipts-container` → `.receipt-card` 반복.  
     각 카드: 날짜 배지(일/월), 상점명, 시간·카드명, 금액.
  5. **상세 모달**  
     클릭 시 `.modal-overlay` → `.modal-content`: 헤더(상호·카드·구매일시), `.modal-items` 테이블(No, 상품명, 단가, 수량, 금액), 총 결제금액, 삭제 버튼.

---

## 5. CSS 변수 (레이아웃·디자인)

| 변수 | 기본값 | 용도 |
|------|--------|------|
| `--header-height` | 60px | 헤더 높이 |
| `--nav-height` | 64px | 하단 네비 높이 |
| `--footer-height` | 0px | 푸터(미사용) |
| `--controls-height` | 100px | 카메라/미리보기 컨트롤 영역 높이 |
| `--page-max-width` | 1200px | 대시보드·영수증 페이지 최대 너비 |
| `--available-height` | calc(100dvh - header - nav - padding) | 메인 사용 가능 높이 |
| `--camera-height` | calc(available-height - controls - gap) | 비디오 영역 최대 높이 |
| `--spacing-xs/sm/md/lg` | 0.5rem ~ 1.5rem | 간격 |
| `--font-size-xs` ~ `--font-size-xl` | 0.75rem ~ 1.5rem | 폰트 크기 |
| `--border-radius` | 8px | 모서리 |
| `--color-bg` / `--color-bg-secondary` / `--color-bg-tertiary` | #1a1a1a ~ #3a3a3a | 배경(다크) |
| `--color-primary` | #4a90d9 | 강조·링크 |
| `--color-danger` | #e74c3c | 삭제·경고 |
| `--color-text` / `--color-text-muted` | #fff / #888 | 글자 |
| `--btn-size` | 80px | 촬영 버튼 기준 크기 |

---

## 6. 브레이크포인트·반응형 요약

| 조건 | 대상 | 주요 변경 |
|------|------|-----------|
| **기본** | 전체 | 100dvh, 헤더 60px, 네비 64px, 다크 테마 |
| **max-width: 480px** | 소형 모바일 | 헤더·컨트롤·버튼 크기·패딩 축소, 미리보기 이미지 max-height 40dvh |
| **481px ~ 768px** | 태블릿 세로 | `.app` max-width 600px |
| **min-width: 769px** | 데스크톱 | `.app` max-width 800px, 카메라/미리보기/결과 영역 max-width |
| **min-width: 1200px** | 대형 데스크톱 | `.app` max-width 1000px, 결과 등 550~700px |
| **landscape & max-height: 600px** | 스마트폰 가로 | 헤더·푸터 축소, 카메라/미리보기 가로 배치(비디오+컨트롤 나란히) |
| **landscape & 601px~1024px** | 태블릿 가로 | 비디오/이미지 ~60vw, 컨트롤 min-width 120px |
| **min-width: 768px** | 네비 | 하단 고정 → 상단 고정(border-bottom) |
| **prefers-color-scheme: light** | 라이트 모드 | 배경·글자색 전환 |
| **prefers-reduced-motion** | 접근성 | 애니메이션·트랜지션 최소화 |

---

## 7. 요약 표

| 화면 | 메인 콘텐츠 | 비고 |
|------|-------------|------|
| **스캔** | 카메라 / 미리보기 / 결과 테이블 중 하나 | 처리 중·에러 오버레이 |
| **대시보드** | 날짜 → 요약 카드 → 월별 차트 → 상점별 → 자주 산 상품 | 최대 너비 1200px |
| **영수증** | 날짜 → 검색 → 상점/카드 필터 → 영수증 카드 목록 | 카드 클릭 시 상세 모달 |

이 문서는 현재 코드 기준으로 작성되었으며, `App.css`, `Navigation.css`, `Dashboard.css`, `ReceiptList.css`와 각 페이지 JSX 구조를 반영합니다.
